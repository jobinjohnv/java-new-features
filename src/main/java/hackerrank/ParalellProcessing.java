package hackerrank;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;
import java.util.stream.Collectors;

public class ParalellProcessing {
    public static void main(String[] args) {
        List<Integer> files = Arrays.asList(34918422, 590100357, 860614062, 295156785, 914782407, 582058092, 325992975, 416760036, 570588480, 574190925, 913714263, 663257133, 786342480, 468340488, 970124463, 601345899, 425469660, 389949483, 907586064, 276415755, 475815186, 597336201, 871148586, 303096255, 808453107, 425445636, 156064986, 174954780, 311929464, 293800584, 912459240, 135517074, 673564584, 654587241, 578935203, 587009808, 979996710, 275213400, 754017495, 878014137, 614874183, 882630672, 567489153, 486509331, 28007826, 571603494, 660525327, 757638420, 57575595, 277931346, 140422128, 286835934, 402449586, 747156333, 34472592, 106455657, 624267336, 807134559, 20659485, 137831232, 641736711, 107727543, 884495766, 105772128, 201282774, 148515906, 905571744, 32752335, 130715277, 920212986, 552581568, 175526736, 805510167, 286664994, 992461701, 294780486, 54420366, 781973808, 425371485, 135717813, 554036175, 68742828, 929645640, 506702427, 677085024, 633905811, 247548147, 526512063, 970227489, 388018785, 380096409, 354248433, 546723408, 452286912, 989035971, 242349261, 193079502, 904348368, 477698991, 960614193, 700347186, 101779062, 81550161, 953044092, 573736086, 460866021, 126338058, 407277024, 242097471, 10103016, 281561511, 92685516, 383041197, 971151258, 403726785, 972468189, 165901428, 815618034, 784206654, 117450333, 653260146, 31668945, 105136878, 571769583, 801766812, 882187383, 740841255, 856015776, 697214133, 879152967, 142376157, 667170042, 271445097, 346377570, 406368963, 564541131, 716855832, 506638671, 357951363, 895494138, 828072861, 369817371, 921771774, 105298809, 430569447, 848516361, 659897007, 912349053, 700091931, 448261275, 433719594, 824089497, 628568325, 154184646, 74902905, 132786885, 555232293, 753105276, 984594996, 366451470, 669970455, 322132272, 570636759, 955977792, 686536620, 911058918, 755970831, 987989541, 78716253, 92786925, 372561882, 114086280, 25389441, 802333686, 274393119, 129030594, 782267871, 513121455, 793603041, 63629181, 196454181, 44997645, 159110259, 638276331, 563866380, 792073590, 786924138, 837193896, 792707916, 997667286, 936135354, 574872837, 268071342, 762495195, 382599294, 123346839, 878751258, 442188054, 964713519, 214792116, 522041058, 562572087, 963890466, 979899228, 445506369, 613773237, 397407087, 61056303, 849845073, 930687450, 855693762, 352328592, 163299906, 796920663, 4463151, 864151365, 144814131, 781538373, 479306751, 283114755, 64573509, 170145129, 311678598, 608116740, 728119854, 984604005, 312707241, 676440996, 188499234, 494218494, 97081677, 138166182, 542606757, 782205963, 884647995, 886909947, 540750210, 876907647, 456785175, 553725942, 387640869, 903606396, 632901654, 898164036, 183666483, 727804077, 406382823, 270180834, 772475781, 412528116, 354436698, 979349448, 3363822, 268187073, 684866721, 896494599, 398445894, 738717210, 61883514, 481981962, 892611489, 489161673, 855342411, 972181980, 732418995, 637531125, 108777438, 967552509, 850844379, 137444076, 246512343, 404273100, 732444636, 323140125, 956071578, 78346422, 775152378, 906917088, 173309367, 761699400, 250163760, 176256927, 967701042, 647389512, 112174755, 30444183, 296082171, 107095296, 539633787, 742232568, 315340410, 263143188, 940848216, 804269928, 478834125, 457334724, 777488943, 209249040, 898578912, 184523955, 487216422, 240368205, 269785362, 723043629, 294229551, 50620878, 339156279, 946891869, 341748792, 820785504, 816159960, 197450484, 342942369, 691369602, 530031117, 298074084, 735659925, 763824831, 661476816, 138332733, 509139708, 123442473, 900191292, 254894178, 831967521, 243103707, 663609870, 701278809, 499397052, 994614159, 931688373, 934066287, 607900755, 139520997, 21483693, 839837460, 313686912, 666051540, 352982553, 128676009, 371129451, 707262633, 134296701, 238801332, 424483290, 158414718, 629416326, 397912515, 723406530, 603058071, 410073972, 920729964, 871213959, 531568884, 642323451, 299524302, 944747265, 65208297, 354194148, 89437425, 54146400, 862940001, 383651730, 911276058, 847958727, 686828142, 874264776, 986000862, 269665242, 827646204, 648568536, 827693559, 863025933, 551911668, 557524275, 581597940, 508861353, 578393046, 183907878, 183741558, 615730269, 80514588, 758050524, 510361929, 10145520, 50166963, 980980308, 385675521, 376805121, 645499701, 998276895, 599251191, 434235648, 692318550, 784374591, 941841747, 442254120, 453380697, 654143721, 728396823, 593821998, 530661516, 210302169, 459153387, 779434425, 686020566, 727422003, 463033494, 629354187, 597275217, 475421793, 860612214, 177675729, 894012273, 535995999, 832062693, 379629789, 884532033, 320397924, 705195414, 889509852, 655377954, 633317916, 505187067, 332807013, 222244638, 685402410, 432620727, 516989550, 193256910, 715704528, 270057249, 550612293, 101935218, 847899129, 664021974, 681206295, 908586294, 654919881, 814364859, 298559415, 200826087, 415365951, 513761325, 364380324, 332877468, 707063049, 736854888, 412758423, 252395220, 957509553, 114726150, 659734845, 206338209, 549485937, 720273708, 854895888, 787012842, 935786082, 115783206, 597198756, 545923917, 456716106, 218201445, 413369880, 137371311, 132123453, 734891619, 52887912, 599265513, 234908751, 68450151, 22568238, 769846539, 227241861, 411736479, 421978557, 764615775, 169991283, 936833667, 667829316, 516252660, 833628180, 719461281, 241760673, 547032717, 422633673, 194744781, 471167928, 663209778, 214420668, 738204159, 601944189, 180958470, 682000704, 571274550, 254493624, 981181047, 94258164, 206920329, 912383010, 521526621, 437321346, 642365955, 385193655, 347707437, 732038307, 202569213, 216768321, 192908562, 551045649, 276837561, 399926142, 838651506, 45045, 568954848, 69777708, 862711311, 311419416, 22610280, 937088460, 822957828, 588576681, 311342955, 266329140, 768825288, 958769889, 590316804, 23283876, 625162692, 290325189, 521193057, 374604846, 460857012, 843460002, 613438287, 552994134, 557012841, 171355107, 847307538, 806832411, 127692411, 909312096, 64441839, 701738730, 286783959, 277297713, 603435756, 414460662, 725870376, 70521297, 144615933, 30554370, 891975315, 764020719, 922698084, 639887094, 248691828, 75884655, 130112829, 454351590, 304213371, 336677649, 481896492, 722334459, 657871599, 41543271, 843985758, 214999785, 481259856, 721406070, 427513086, 208772487, 129207771, 563806089, 551020932, 865076058, 394150911, 180776442, 939768522, 123001032, 992953038, 824903079, 128967531, 521868039, 16559466, 669317649, 167900271, 496565916, 272554128, 394407090, 935845449, 507197460, 203848491, 247379286, 666563205, 597884826, 667006494, 782813262, 501463347, 787113558, 659292942, 288186822, 787690134, 537305307, 239414175, 707861847, 326380362, 870197097, 715013607, 251667108, 92516193, 853223679, 627115566, 603627948, 674846865, 531324024, 453539625, 451772475, 754105737, 384559791, 595835163, 394497180, 484375584, 307771926, 202397580, 337723155, 227610768, 216358989, 33409761, 396920832, 404914125, 374598147, 273811230, 670106976, 277537953, 314528445, 78901515, 681093798, 374640189, 486313443, 972368166, 195110685, 497391972, 125377329, 188583318, 646319520, 257679576, 998570727, 575720607, 620829363, 239372595, 414564843, 924301686, 536125590, 214827228, 731142027, 712843131, 437919405, 279795516, 906919860, 229412799, 628926837, 112667247, 467686296, 327318453, 109785753, 109217262, 294490581, 537935937, 646615893, 838031733, 870488157, 19323843, 34972245, 860722401, 182043477, 940942233, 138461400, 901611018, 724972710, 661206084, 533291451, 726494076, 288147783, 736570989, 32978484, 892960992, 591467415, 476100702, 412270089, 159730956, 518583219, 295288455, 788648553, 601202448, 493738707, 341502084, 355085346, 264329835, 776289360, 771452913, 976540257, 771468852, 213245571, 292584138, 369350289, 633212811, 230101410, 433146483, 654978093, 244814031, 894020820, 305829216, 349789902, 520587375, 702224523, 700505421, 657184836, 606420507, 789147975, 931315077, 499160739, 365736987, 648041394, 615799338, 962153577, 826865193, 104742792, 748021428, 163921527, 696689301, 69735897, 202672701, 472103940, 61146393, 253703835, 853527213, 918128211, 982683702, 555013536, 119526561, 350601636, 611446836, 662284392, 72668442, 329176848, 444629955, 179346321, 514752777, 684537546, 284889990, 246195180, 577393047, 735273, 164476389, 820311492, 477574482, 65452233, 82483863, 751611630, 455482104, 794669568, 933287586, 447620943, 632565780, 438089190, 372967518, 487795308, 103504401, 949470522, 776610450, 386652189, 217881510, 392161539, 713031396, 283735452, 607526535, 842709021, 9290820, 13578873, 14060970, 18279954, 74257722, 823241727, 820044918, 55614174, 890762103, 988058148, 850735578, 887260143, 247022160, 491402142, 332261622, 764983065, 939426180, 921472860, 31698744, 882265461, 874232436, 14712852, 574016751, 544810728, 111731928, 855870939, 981132768, 944532666, 351669780, 650973708, 8738268, 443183202, 311307381, 439580064, 896734608, 317829204, 662574759, 296733129, 270173673, 187106073, 693185955, 624933771, 723893016, 191967699, 6017088, 18156831, 921424350, 50703345, 171637158, 173325306, 351419838, 561397452, 650683341, 186520026, 998814201, 318029250, 280016352, 966453411, 28660170, 811094823, 639085293, 364750386, 791592186, 573430242, 222591831, 327187245, 419225268, 255777522, 197274000, 224443065, 813474354, 79723875, 294013797, 909301470, 74235546, 340788525, 492051021, 398574561, 5417412, 738742851, 246385524, 401605281, 270546045, 589994328, 981868272, 235301220, 631801401, 963684183, 108170601, 308350581, 778494255, 335261850, 213176502, 507995565, 668568747, 185566689, 432938583, 568085826, 877667637, 637784301, 630533904, 208594848, 803095524, 734560827, 667553733, 333982572, 898163805, 162356502, 45657612, 604111200, 400634619, 309134364, 882439173, 547561476, 33881232, 86208738, 209315337, 157262259, 188684727, 731188458, 569664942, 647373573, 507798753, 624666735, 62270208, 651178605, 168966798, 217177191, 510246429, 7138593, 591379173, 151086936, 570210333, 312797331, 128144478, 959743092, 567625905, 370743219, 390796560, 801122553, 836066847, 615129438, 963774042, 874636455, 507446709, 807796836,
                572507859, 143520069, 97348482, 153110265, 110305272, 657251826, 435707118, 780272262, 855581958, 379475943, 780272262,582058092);
        minTime(files,231,689);
    }

    public static long minTime(List<Integer> files, int numCores, int limit) {
        // Write your code here
        long finalTime= 0;

       Collections.sort(files,Collections.reverseOrder());
       for (int file : files){
           System.out.println("File : "+file+" | Limit : "+limit);
           if(limit>0 && file >= numCores && ((file%numCores)==0)){
            finalTime += file/numCores;
               limit--;
           }else{
               finalTime += file;
           }

       }
        System.out.println("Final time is : "+finalTime);
        return finalTime;
    }
}
